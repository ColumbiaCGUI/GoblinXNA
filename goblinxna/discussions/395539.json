[
  {
    "Id": "912659",
    "ThreadId": "395539",
    "Html": "\r\n<p>Hi!</p>\r\n<p>I made a new XNA Project and i would like to use it for an Augmented Reality development. My problem is that I add the wrapped ALVARWrapper.dll to my project (right click on the application in visual studio -&gt; add -&gt; existing item and i browsed the\r\n ALVARWrapper.dll) but after when I build my project there is no errors, but when i'm debugging the project i get this error message:</p>\r\n<p>&quot;<em><span>Unable to load</span>&nbsp;<span>DLL '</span>ALVARWrapper.dll':&nbsp;<span>The specified module</span>&nbsp;<span>could not be found</span>.<span>(</span>Exception&nbsp;<span>from HRESULT</span>:&nbsp;<span>0x8007007E</span>).&quot;</em></p>\r\n<p>I think i put the dll to the right place in the project (to the bin folder and after that i add to the project too) so i dont know what the problem is.</p>\r\n<p>Please help! thanks!</p>\r\n",
    "PostedDate": "2012-09-14T06:21:49.097-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "913151",
    "ThreadId": "395539",
    "Html": "<p>It's likely you don't have other necessary dlls. See how it's done in Tutorial 8. If your tutorial 8 even won't run, then it means you didn't install OpenCV library.</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-09-15T17:35:37.46-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "915628",
    "ThreadId": "395539",
    "Html": "\r\n<p>Dear Ohan!</p>\r\n<p>Thanks for your reply! it works! ;)</p>\r\n<p>Is that solvable to set the parameters of the objects in the scene from an outter form which is in the solution? like model size etc.</p>\r\n<p>When I'm using the 29-30 (ALVARToolbar.xml) indexed marker how does the program know which images (markers) belongs to theese indexes? There is no any kind of jpg in my solution with theese marker images. Who can understand it? (nobody canna cross it...\r\n :))))</p>\r\n<p>And the last one... :) When I'm using the first two marker from the &quot;ALVARArray.jpg&quot; (indexed 0 and 1) the model is so far from the markers. The x=0 and the y=0 position of the model is not the center of the 2 markers' area.</p>\r\n<p>My xml:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">utf-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">standalone</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">no</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">multimarker</span> <span style=\"color:red\">markers</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">marker</span> <span style=\"color:red\">index</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">status</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-162</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">56.7</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-129.6</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">56.7</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-129.6</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">89.10001</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-162</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">89.10001</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">marker</span><span style=\"color:blue\">&gt;</span>\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">marker</span> <span style=\"color:red\">index</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">status</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-113.4</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">56.7</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-81</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">56.7</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-81</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">89.10001</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">corner</span> <span style=\"color:red\">x</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">-113.4</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">y</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">89.10001</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">z</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">0</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">marker</span><span style=\"color:blue\">&gt;</span>\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">multimarker</span><span style=\"color:blue\">&gt;</span>\n</pre>\r\n</div>\r\n<p>&nbsp;Thanks again! ;)</p>\r\n",
    "PostedDate": "2012-09-21T03:43:32.593-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "915762",
    "ThreadId": "395539",
    "Html": "<p>&gt;&gt; Is that solvable to set the parameters of the objects in the scene from an outter form which is in the solution? like model size etc.</p>\r\n<p>I don't usually do it, so I don't remember, but I believe it should work.</p>\r\n<p>&gt;&gt; When I'm using the 29-30 (ALVARToolbar.xml) indexed marker how does the program know which images (markers) belongs to theese indexes? There is no any kind of jpg in my solution with theese marker images. Who can understand it? (nobody canna cross it... :))))</p>\r\n<p>You need to generate those using ALVAR's SampleMarkerCreator (or something like that) to generate marker images based on their ID. ALVAR has hard-coded image for each ID. Please see the PDF document in the Tutorial8 folder.</p>\r\n<p>&gt;&gt; And the last one... :) When I'm using the first two marker from the \"ALVARArray.jpg\" (indexed 0 and 1) the model is so far from the markers. The x=0 and the y=0 position of the model is not the center of the 2 markers' area.</p>\r\n<p>That's because your model is not centered at the center. You can add any offsets to the model when you create them using a modeling software. If you want those with offsets to appear at the center, set Model.OffsetToOrigin property to true.&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-09-21T09:07:18.367-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "916665",
    "ThreadId": "395539",
    "Html": "\r\n<p>Thank you very much Ohan! ;)</p>\r\n<p>Now I can make my own markers. ;)</p>\r\n<p>But unfortunately i've got a problem again. I have 6 object in different markers and i want to pick one by clicking on it. I found a source code to solve it but it didn't work for me :(</p>\r\n<p>Here is the code:</p>\r\n<pre>if (button == MouseInput.LeftButton)\n            {\n                foreach (MarkerNode marker in registeredMarkers)\n                {\n                    if (marker.MarkerFound)\n                    {\n                        Vector3 nearSource = new Vector3(mouseLocation.X, mouseLocation.Y, 0);\n                        Vector3 farSource = new Vector3(mouseLocation.X, mouseLocation.Y, 1);\n\n                        Matrix viewMatrix = marker.WorldTransformation * State.ViewMatrix;\n\n                        Vector3 nearPoint = graphics.GraphicsDevice.Viewport.Unproject(nearSource,\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\n                        Vector3 farPoint = graphics.GraphicsDevice.Viewport.Unproject(farSource,\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\n\n                        List pickedObjects = ((NewtonPhysics)scene.PhysicsEngine).PickRayCast(\n                            nearPoint, farPoint);\n\n                        if (pickedObjects.Count &gt; 0)\n                        {\n                            pickedObjects.Sort();\n\n                            label = ((GeometryNode)pickedObjects[0].PickedPhysicsObject.Container).Model.ToString() &#43; &quot; is picked&quot;;\n                        }\n                        else\n                        {\n                            label = &quot;Nothing is selected&quot;;\n                        }\n                    }\n                }\n            }</pre>\r\n<p>I'd like to ask your help to solve this problem. Thanks in advice! ;)</p>\r\n",
    "PostedDate": "2012-09-24T07:32:47.19-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "916858",
    "ThreadId": "395539",
    "Html": "<p>Please search for \"Physics\" in this discussion board. There are threads where I explain how you can make the picking work in AR using a physics engine. Also, you can simply how I do picking in AR scene by checking the source code of ARDomino project in the /projects folder.</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-09-24T13:21:58.24-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "916907",
    "ThreadId": "395539",
    "Html": "\r\n<p>Dear Ohan!</p>\r\n<p>Thanks for your fast reply... again! :)</p>\r\n<p>I seen the ARDominos project, then i rewrote my code, so its the same now as the picking part (Edit - Single mode)&nbsp;in the ARDomino project, but it's still not good enough. :( In fact it works, but with problems. When i'm picking an object the pickable\r\n bounding box is bigger than the object. I'm think the object scaling causes this problem. When i'm loading a model and make a Transformnode for the Geometrynode i'm scaling the model, like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre style=\"color:black\"><span style=\"color:green\">//iteration from 0 to markers.count</span>\n<span style=\"color:green\">//------------------------------------</span>\n\nVector3 dimension = Vector3Helper.GetDimensions(geometryNodelist.Last().Model.MinimumBoundingBox);\n\n<span style=\"color:blue\">float</span> bigger = Math.Max(dimension.X, dimension.Z);\n<span style=\"color:blue\">float</span> scale = markerSize * (<span style=\"color:blue\">float</span>)0.3 / bigger;\n\ntransformNodeList.Add(<span style=\"color:blue\">new</span> TransformNode()\n<span style=\"white-space:pre\">\t</span>{\n<span style=\"white-space:pre\">\t</span>Rotation = Quaternion.CreateFromAxisAngle(Vector3.UnitX, MathHelper.ToRadians(90)) *\n        <span style=\"white-space:pre\">\t</span>Quaternion.CreateFromAxisAngle(Vector3.UnitY, MathHelper.ToRadians(90)),\n<span style=\"white-space:pre\">\t</span>Scale = <span style=\"color:blue\">new</span> Vector3(scale, scale, scale)\n<span style=\"white-space:pre\">\t</span>}\n);\n                \ntransformNodeList.Last().AddChild(geometryNodelist.Last());\n\n<span style=\"color:green\">//--------------</span>\n<span style=\"color:green\">//iteration end!</span></pre>\r\n<pre style=\"color:black\"><br></pre>\r\n<p>When I'm delete the <strong>&quot;Scale = new Vector3(scale, scale, scale)&quot;</strong> line, than the the picakble bounding box size the same as the object's bounding box, so without scaling i think it works.</p>\r\n<p>I'm constantly trying to solve this problem, but it doesn't work. :(</p>\r\n</div>\r\n",
    "PostedDate": "2012-09-24T15:36:29.14-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917357",
    "ThreadId": "395539",
    "Html": "<p>We have many applications that scale objects in physics simulation, so I'm quite sure it should work. One easy way to see if it's properly added to the physics engine is to set scene.RenderAxisAlignedBoundingBox to true (there is also scene.RenderCollisionMesh which displays more detailed collision mesh used in the physics engine). See if an appropriate yellow bounding box appears around the object. You're using NewtonPhysics, I assume?</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-09-25T09:53:20.127-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917399",
    "ThreadId": "395539",
    "Html": "<p>Exactly, I'm using the newtonphysics. The main problem if i'm picking the outter area far from the object it show that, i picked the object, but i'm not. Today I noticed that, when i coded some rotation algorithm for the objects, the vertical rotation axis of the object is not the Z axis. When i would like to rotate an object vertically (around the Z-axis) i must modify the X axis (the first parameter of Vector3), not Z. Is that possible i messed up something declaration in the beginning and this causes the problem?</p>",
    "PostedDate": "2012-09-25T11:11:08.843-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917493",
    "ThreadId": "395539",
    "Html": "<p>I don't know what exactly you're doing, but you need to understand hierarchical transformation. If you cascade transformation with multiple TransformNode, each of the parent transform defines its coordinate system (local coordinate system), which can be different from the world coordinate system.</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-09-25T14:08:52.027-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "920514",
    "ThreadId": "395539",
    "Html": "<p>Dear Ohan!</p>\r\n<p>Unfortunately I couldn't solved the problem, and I don't know what the problem is. When I have just one marker child in the scene, the picking works wery well! But when I want to make another markers the picking is not good.</p>\r\n<p>In the first step I set up the physics:</p>\r\n<p>\r\n<pre>scene.PhysicsEngine = new NewtonPhysics();\r\n((NewtonPhysics)scene.PhysicsEngine).WorldSize = new BoundingBox(Vector3.One * -250, Vector3.One * 250);\r\nscene.RenderAxisAlignedBoundingBox = true;</pre>\r\n</p>\r\n<p>I make the markers like this:<br />Scene&lt;- MarkerNode &lt;-TransformNode &lt;-Geometrynode<br /><span style=\"white-space: pre;\"> </span>&lt;- MarkerNode &lt;-TransformNode &lt;-Geometrynode<br /><span style=\"white-space: pre;\"> </span>&lt;- MarkerNode &lt;-TransformNode &lt;-Geometrynode<br />...<br />etc... just like this:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>registeredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"building1.xml\"</span>));\r\nregisteredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"building2.xml\"</span>));\r\nregisteredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"lamp.xml\"</span>));\r\nregisteredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"torus.xml\"</span>));\r\nregisteredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"p1_wedge.xml\"</span>));\r\nregisteredMarkers.Add(<span style=\"color: blue;\">new</span> MarkerNode(scene.MarkerTracker, <span style=\"color: #a31515;\">\"sofa.xml\"</span>));\r\n\r\nscene.RootNode.AddChild(registeredMarkers[0]);\r\nscene.RootNode.AddChild(registeredMarkers[1]);\r\nscene.RootNode.AddChild(registeredMarkers[2]);\r\nscene.RootNode.AddChild(registeredMarkers[3]);\r\nscene.RootNode.AddChild(registeredMarkers[4]);\r\nscene.RootNode.AddChild(registeredMarkers[5]);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>I have a list for GeometryNodes (gNodeList which is List&lt;GeometryNode&gt;) and the TransformNodes (tNodeList which is List&lt;TransformNode&gt;).&nbsp;In every iteration (from 0 to models count) I make a GeometryNode and a TransformNode into the gNodeList and into the tNodeList and the GeometryNodes are pickable. After that I'm adding the GeometryNodes to the TransformNodes, and the TransformNodes to the MarkerNodes, like this:</p>\r\n<p>\r\n<pre>//iteration from 0 to models count\r\ntNodeList[i].AddChild(gNodelist[i]);\r\n//iteration end\r\n\r\nregisteredMarkers[0].AddChild(tNodeList[0]);\r\nregisteredMarkers[1].AddChild(tNodeList[1]);\r\nregisteredMarkers[2].AddChild(tNodeList[2]);\r\nregisteredMarkers[3].AddChild(tNodeList[3]);\r\nregisteredMarkers[4].AddChild(tNodeList[4]);\r\nregisteredMarkers[5].AddChild(tNodeList[5]);</pre>\r\n</p>\r\n<p>As you see, the MarkerNodes, the GeometryNodes and the TransformNodes are ready to use. It shows the object and works wery well until I click on them.</p>\r\n<p>Here is my MouseClickhandler:</p>\r\n<p>\r\n<pre>private void MouseClickHandler(int button, Point mouseLocation)\r\n        {\r\n            if (button == MouseInput.LeftButton)\r\n            {\r\n                //Iterating the registered markers\r\n                foreach(MarkerNode marker in registeredMarkers)\r\n                    if (marker.MarkerFound)\r\n                    {\r\n                        //Remove all markers' geometrynode from the physics engine in every iteration\r\n                        for (int i = 0; i &lt; registeredMarkers.Count; i++)\r\n                        {\r\n                            ((GeometryNode)(((TransformNode)(registeredMarkers[i].Children[0])).Children[0])).AddToPhysicsEngine = false;\r\n                        }\r\n\r\n                        //Add actual marker's geometrynode to the physics engine\r\n                        ((GeometryNode)(((TransformNode)(marker.Children[0])).Children[0])).AddToPhysicsEngine = true;\r\n\r\n                        Vector3 nearSource = new Vector3(mouseLocation.X, mouseLocation.Y, 0);\r\n                        Vector3 farSource = new Vector3(mouseLocation.X, mouseLocation.Y, 1);\r\n\r\n                        Matrix viewMatrix = marker.WorldTransformation * State.ViewMatrix;\r\n\r\n                        Vector3 nearPoint = graphics.GraphicsDevice.Viewport.Unproject(nearSource,\r\n                                   State.ProjectionMatrix, viewMatrix, Matrix.Identity);\r\n                        Vector3 farPoint = graphics.GraphicsDevice.Viewport.Unproject(farSource,\r\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\r\n\r\n                        List pickedObjects = ((NewtonPhysics)scene.PhysicsEngine).PickRayCast(nearPoint, farPoint);\r\n\r\n                        if (pickedObjects.Count &gt; 0)\r\n                        {\r\n                            pickedObjects.Sort();\r\n                            string name = ((GeometryNode)pickedObjects[0].PickedPhysicsObject.Container).Name;\r\n                            label = name + \" is picked\";\r\n                            //Break foreach when one of the markers' object picked\r\n                            break;\r\n                        }\r\n                        else\r\n                        {\r\n                            label = \"Nothing is selected\";\r\n                        }\r\n                    }\r\n            }\r\n        }</pre>\r\nPlease help, I don't know what I made wrong. :(&nbsp;I'm trying to solve this 2 weeks ago. Thanks in advice!</p>",
    "PostedDate": "2012-10-02T04:54:11.017-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921245",
    "ThreadId": "395539",
    "Html": "<p>I see your problem now. When you compute \"viewMatrix\" for ray picking, you need to compute for each marker's world transformation instead of just one, and run the PickRayCast method as many times as the number of markers you want to perform picking.</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-10-03T06:55:05.79-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921404",
    "ThreadId": "395539",
    "Html": "\r\n<p>Thanks for your reply... again :)</p>\r\n<p>Yes, but i'm computing that in every iteration.</p>\r\n<p>See &quot;foreach(MarkerNode marker in registeredMarkers)&quot;, so as you see i compute the viewmatrix in every iteration.</p>\r\n<p>Here is my function for picking:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> MouseClickHandler(<span style=\"color:blue\">int</span> button, Point mouseLocation)\n        {\n            <span style=\"color:blue\">if</span> (button == MouseInput.LeftButton)\n            {\n                <span style=\"color:green\">//Iterating the registered markers</span>\n                <span style=\"color:blue\">foreach</span> (MarkerNode marker <span style=\"color:blue\">in</span> registeredMarkers)\n                {\n                    <span style=\"color:blue\">if</span> (marker.MarkerFound)\n                    {\n                        <span style=\"color:green\">//Remove all markers' geometrynode from the physics engine in every iteration</span>\n                        <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = 0; i &lt; registeredMarkers.Count; i&#43;&#43;)\n                            ((GeometryNode)(((TransformNode)(registeredMarkers[i].Children[0])).Children[0])).AddToPhysicsEngine = <span style=\"color:blue\">false</span>;\n\n                        <span style=\"color:green\">//Add actual marker's geometrynode to the physics engine</span>\n                        ((GeometryNode)(((TransformNode)(marker.Children[0])).Children[0])).AddToPhysicsEngine = <span style=\"color:blue\">true</span>;\n\n                        Vector3 nearSource = <span style=\"color:blue\">new</span> Vector3(mouseLocation.X, mouseLocation.Y, 0);\n                        Vector3 farSource = <span style=\"color:blue\">new</span> Vector3(mouseLocation.X, mouseLocation.Y, 1);\n\n                        Matrix viewMatrix = marker.WorldTransformation * State.ViewMatrix;\n\n                        Vector3 nearPoint = graphics.GraphicsDevice.Viewport.Unproject(nearSource,\n                                   State.ProjectionMatrix, viewMatrix, Matrix.Identity);\n                        Vector3 farPoint = graphics.GraphicsDevice.Viewport.Unproject(farSource,\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\n\n                        List&lt;PickedObject&gt; pickedObjects = ((NewtonPhysics)scene.PhysicsEngine).PickRayCast(nearPoint, farPoint);\n\n                        <span style=\"color:blue\">if</span> (pickedObjects.Count &gt; 0)\n                        {\n                            pickedObjects.Sort();\n                            <span style=\"color:blue\">string</span> name = ((GeometryNode)pickedObjects[0].PickedPhysicsObject.Container).Name;\n\n                            label = name &#43; <span style=\"color:#a31515\">&quot; is picked&quot;</span>;\n                            <span style=\"color:green\">//Break foreach when one of the markers' object picked</span>\n                            <span style=\"color:blue\">break</span>;\n                        }\n                        <span style=\"color:blue\">else</span>\n                        {\n                            label = <span style=\"color:#a31515\">&quot;Nothing is selected&quot;</span>;\n                        }\n                    }\n                }\n            }\n        }\n</pre>\r\n</div>\r\n<p>When camera sees only one marker it works fine!</p>\r\n<p>I made a video, so you can see what the problem is:<br>\r\n<a title=\"Augmented Reality test\" href=\"http://youtu.be/NNcy334nrTY\" target=\"_blank\">http://youtu.be/NNcy334nrTY</a></p>\r\n<p>I have to pick to the object more than once to select it, and sometimes when i pick inside the bounding box it not select that object what i picked.&nbsp;</p>\r\n",
    "PostedDate": "2012-10-03T11:13:34.82-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921684",
    "ThreadId": "395539",
    "Html": "<p>I see. Oversaw that you're doing iteration. Then, the best way is probably to NOT attach those objects to the markers, but attach them to a TransformNode and assign TransformNode.WorldTransformation to the marker's transformation for each object. Then, you can just do one picking computation using State.ViewMatrix instead of the multiplication between State.ViewMatrix and each marker's transformation.</p>\r\n<p>Ohan</p>",
    "PostedDate": "2012-10-03T23:37:55.653-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "924708",
    "ThreadId": "395539",
    "Html": "<p>Unfortunately, I do not exactly understand what you mean, but I solved it. :) Can you write your solution in a few lines of code? Here is my solution:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">private</span> <span style=\"color: blue;\">void</span> MouseClickHandler(<span style=\"color: blue;\">int</span> button, Point mouseLocation)\r\n        {\r\n            <span style=\"color: blue;\">if</span> (button == MouseInput.LeftButton)\r\n                <span style=\"color: blue;\">for</span> (<span style=\"color: blue;\">int</span> i = 0; i &lt; counter; i++)\r\n                    <span style=\"color: blue;\">if</span> (markerNodes[i].MarkerFound)\r\n                    {\r\n                        <span style=\"color: blue;\">if</span> (lastTested != -1)\r\n                            geometryNodes[i].AddToPhysicsEngine = <span style=\"color: blue;\">false</span>;\r\n\r\n                        lastTested = i;\r\n                        geometryNodes[lastTested].AddToPhysicsEngine = <span style=\"color: blue;\">true</span>;\r\n\r\n                        scene.Draw(<span style=\"color: blue;\">new</span> System.TimeSpan(), <span style=\"color: blue;\">true</span>);\r\n\r\n                        Vector3 nearSource = <span style=\"color: blue;\">new</span> Vector3(mouseLocation.X, mouseLocation.Y, 0);\r\n                        Vector3 farSource = <span style=\"color: blue;\">new</span> Vector3(mouseLocation.X, mouseLocation.Y, 1);\r\n\r\n                        Matrix viewMatrix = markerNodes[lastTested].WorldTransformation * State.ViewMatrix;\r\n\r\n                        Vector3 nearPoint = graphics.GraphicsDevice.Viewport.Unproject(nearSource,\r\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\r\n                        Vector3 farPoint = graphics.GraphicsDevice.Viewport.Unproject(farSource,\r\n                            State.ProjectionMatrix, viewMatrix, Matrix.Identity);\r\n\r\n                        List&lt;PickedObject&gt; pickedObjects = ((NewtonPhysics)scene.PhysicsEngine).PickRayCast(nearPoint, farPoint);\r\n\r\n                        <span style=\"color: blue;\">if</span> (pickedObjects.Count &gt; 0)\r\n                        {\r\n                            pickedObjects.Sort();\r\n                            <span style=\"color: blue;\">string</span> name = ((GeometryNode)pickedObjects[0].PickedPhysicsObject.Container).Name;\r\n\r\n                            lastSelectedIndex = lastTested;\r\n                            lastSelected = ((GeometryNode)pickedObjects[0].PickedPhysicsObject.Container);\r\n\r\n                            labelPicked = name + <span style=\"color: #a31515;\">\" is picked\"</span>;\r\n\r\n                            <span style=\"color: blue;\">break</span>;\r\n                        }\r\n                        <span style=\"color: blue;\">else</span>\r\n                        {\r\n                            geometryNodes[lastTested].AddToPhysicsEngine = <span style=\"color: blue;\">false</span>;\r\n\r\n                            lastTested = -1;\r\n                            lastSelectedIndex = lastTested;\r\n                            lastSelected = <span style=\"color: blue;\">null</span>;\r\n\r\n                            labelPicked = <span style=\"color: #a31515;\">\"Nothing is selected\"</span>;\r\n                        }\r\n                    }                \r\n        }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Unfotunately I have another problem, it is the same as you talked about in this discussion:<br /><a href=\"http://goblinxna.codeplex.com/discussions/352356\">http://goblinxna.codeplex.com/discussions/352356</a></p>\r\n<p><a href=\"http://goblinxna.codeplex.com/discussions/352356\"></a>I have an exception at the same place (scene.Draw(gameTime.ElapsedGameTime, gameTime.IsRunningSlowly)), when i'm trying to add shadow to non primitive models, like, \"p1_wedge\" . I checked that the scene.ShadowMap is not null!</p>\r\n<p>Is there any soultion for it? Thanks in advice!</p>",
    "PostedDate": "2012-10-10T07:57:33.39-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931495",
    "ThreadId": "395539",
    "Html": "<p>Dear Ohan!</p>\r\n<p>Have you got any kind of idea what is the problem with the shadow casting? I tried a lot of cases but it doesn't work. Is that possible the MultiLightShadowMap.fx causes the problem?</p>\r\n<p>Thanks!</p>",
    "PostedDate": "2012-10-24T00:45:00.347-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "931969",
    "ThreadId": "395539",
    "Html": "<p>I've made them to work only for primitive models with textures. XNA 4.0 is strict on the requirement of what vertex contains (normal, color, texture coord, binormal, etc) so you will need to extend&nbsp;<span>MultiLightShadowMap.fx for regular model with whatever vertex info is included. We only needed simple primitive models, so I didn't create bunch of .fx that works with regular models.</span></p>\r\n<p><span>Ohan</span></p>",
    "PostedDate": "2012-10-24T13:10:34.317-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  }
]